<html lang="en">
  <body>
    <div id="elements">
    <div id="carte">
       <!-- <iframe id="myIFrame"
          src="https://maps.google.com/maps?q=versailles&t=&z=13&ie=UTF8&iwloc=&output=embed"
          referrerpolicy="no-referrer-when-downgrade"
          width="100%"
          height="500"
          style="border:0;"
          allowfullscreen=""
          loading="lazy"
        ></iframe> -->
        <script type="text/javascript"
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDZSA-7PEiaq8X_zc3402GlJJ5BhoEpayE&callback=initMap"
        defer
      ></script>
      <script type="text/javascript" src="/script/googlemaps.js"></script>
    </div>
      <div id="recherche">
        <form action="/index" method="post" id="search_form"  autocomplete="off">
          <div class="form-row">
            <ul style="list-style: none;">
              <li>
                <label class="input_label">Gazole</label>
                <input class="fuel_choice" type="checkbox" name="Gazole" {{#if Gazole}}checked{{/if}}/>
              </li>
              <li>
                <label class="input_label">SP95</label>
                <input class="fuel_choice" type="checkbox" name="SP95" {{#if SP95}}checked{{/if}}/>
              </li>
              <li>
                <label class="input_label">SP98</label>
                <input class="fuel_choice" type="checkbox" name="SP98" {{#if SP98}}checked{{/if}}/>
              </li>
              <li>
                <label class="input_label">E85</label>
                <input class="fuel_choice" type="checkbox" name="E85" {{#if E85}}checked{{/if}}/>
              </li>
              <li>
                <label class="input_label">E10</label>
                <input class="fuel_choice" type="checkbox" name="E10" {{#if E10}}checked{{/if}}/>
              </li>
              <li>
                <label class="input_label">GPLc</label>
                <input class="fuel_choice" type="checkbox" name="GPLc" {{#if GPL}}checked{{/if}}/>
              </li>
            </ul>
          </div>
          <div class="form-row">
            <div style="margin-bottom: 5px;">
              <label class="input_label" style="margin-right: 5px;">Recherche par</label>
              <input type="radio" id="radio_dep" name="radio" value="departement" onclick = "replace_dep()" checked>
              <label for="radio_dep" style="margin-right: 5px;">Département</label>
              <input type="radio" id="radio_ville" name="radio" onclick = "replace_ville()" value="ville">
              <label for="radio_ville">Ville</label>
              <script type = "text/javascript">
                function replace_dep() {
                document.getElementById("search_mode_1").style.display="block";
                document.getElementById("search_mode_2").style.display="none";
                }
                function replace_ville() {
                document.getElementById("search_mode_1").style.display="none";
                document.getElementById("search_mode_2").style.display="block";
                }
              </script>
            </div>
              <div id="search_mode_1" style="display:block">
                <label class="input_label" for="departement-recherche">Département</label>
                <div class="autocomplete">
                  <input id="input-departement" type="text" name="departement-recherche" placeholder="Département à rechercher...">
                </div>
              </div>
              <script type="text/javascript" src="/script/autocomplete.js"></script>
              <script>
                autocomplete(document.getElementById("input-departement"), departements);
              </script>
              <div id="search_mode_2" style="display:none">
                <label class="input_label" for="ville-recherche">Ville</label>
                <div class="autocomplete">
                  <input type="text" id="input-ville" name="ville-recherche" placeholder="Ville à rechercher..."/>
                </div>
              </div>
<!--               <script type="text/javascript" src="/script/autocomplete.js"></script>
              <script>
                var JsonVille = fs.readFileSync("ville.json");
                var villes = JSON.parse(JsonVille);
                console.log("utilise le script d'auto complétion");
                console.log(villes);
                autocomplete(document.getElementById("input-ville"), villes);
              </script> -->             
              <input class="fuel_choice" type="submit" value="Rechercher"/>
          </div>
        </form>
      </div>
    </div>

    <div id="tableau">
      <table id="tableau_resultats"  class="result-table">
        <thead>
          <tr>
            <th>
              Stations{{#if Departement}} ({{Departement}}){{/if}}
            </th>
            {{#if Gazole}}
              <th>
                Gazole
              </th>
            {{/if}}
            {{#if SP98}}
              <th>
                SP98
              </th>
            {{/if}}
            {{#if SP95}}
              <th>
                SP95
              </th>
            {{/if}}
            {{#if E85}}
              <th>
                E85
              </th>
            {{/if}}
            {{#if E10}}
              <th>
                E10
              </th>
            {{/if}}
            {{#if GPLc}}
              <th>
                GPLc
              </th>
            {{/if}}
          </tr>
        </thead>
        <tbody>
          {{#each address}}
          <tr>
            <td>
              <div class="table-row">
                <div>
                  <strong>
                    {{[1].[0]}}
                  </strong>
                  <br />
                    {{[1].[1]}}
                  <br />
                    {{[1].[2]}}
                </div>
                <div>
                  <input type="button" class ="buttonlist" value="Ajouter aux favoris" />
                  <input type="button" class ="buttonlist" value="Emplacement sur la carte" onclick="getEmplacement({{[0].[0]}},{{[0].[1]}})"/>
                  <script> window.addEventListener('load', function() {
                            var tab = [];
                            {{#if ../Gazole}} tab.push("Gazole: " + "{{[2].Gazole}}"); {{/if}}
                            {{#if ../SP98}} tab.push("SP98: " + "{{[2].SP98}}"); {{/if}}
                            {{#if ../SP95}} tab.push("SP95: " + "{{[2].SP95}}"); {{/if}}
                            {{#if ../E85}} tab.push("E85: " + "{{[2].E85}}"); {{/if}}
                            {{#if ../E10}} tab.push("E10: " + "{{[2].E10}}"); {{/if}}                           
                            {{#if ../GPLc}} tab.push("Gazole: " + "{{[2].GPLc}}"); {{/if}}
                            setMarker({{[0].[0]}},{{[0].[1]}},"{{[1].[0]}}",{{[1].[1]}},"{{[1].[2]}}",tab);
                          });
                  </script>
                </div>
              </div>
            </td>
            {{#if ../Gazole}}
            <td>
              {{[2].Gazole}}
            </td>
            {{/if}}
            {{#if ../SP98}}
            <td>
              {{[2].SP98}}
            </td>
            {{/if}}
            {{#if ../SP95}}
            <td>
              {{[2].SP95}}
            </td>
            {{/if}}
            {{#if ../E85}}
            <td>
              {{[2].E85}}
            </td>
            {{/if}}
            {{#if ../E10}}
            <td>
              {{[2].E10}}
            </td>
            {{/if}}
            {{#if ../GPLc}}
            <td>
              {{[2].GPLc}}
            </td>
            {{/if}}
          </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
  </body>
</html>